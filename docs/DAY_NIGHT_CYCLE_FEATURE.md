# 昼夜循环系统功能演示

## 🎮 游戏运行时的视觉效果

### 时间线

```
游戏启动
    ↓
[0秒 - 150秒] 白天场景
    ├─ 背景：纯白色 RGB(255,255,255)
    ├─ 云朵：完全可见（透明度100%）
    └─ 状态：isNight = false

    ↓ [150秒]
[150秒 - 225秒] 过渡期（白天→黑夜）
    ├─ 背景：从白色逐渐变深灰
    ├─ 云朵：逐渐消失（从100% → 0%）
    ├─ 动画：线性平滑变化（75秒内）
    └─ 状态：isNight = false（逻辑值）

    ↓ [225秒]
[225秒 - 300秒] 黑夜场景
    ├─ 背景：深灰色 RGB(100,100,120)
    ├─ 云朵：完全隐藏（透明度0%）
    └─ 状态：isNight = true

    ↓ [300秒]
[300秒 - 450秒] 过渡期（黑夜→白天）
    ├─ 背景：从深灰逐渐变白
    ├─ 云朵：逐渐出现（从0% → 100%）
    ├─ 动画：线性平滑变化（75秒内）
    └─ 状态：isNight = true（逻辑值）

    ↓ [450秒]
回到白天，循环重复...
```

**时间换算（60FPS）：**
- 1帧 = 1/60秒 ≈ 0.0167秒
- 9000帧 = 150秒
- 4500帧 = 75秒
- 18000帧 = 300秒（完整周期）

## 📊 参数对应表

| 变量 | 配置值 | 时间 | 功能 |
|------|-------|------|------|
| `gameFrameCount` | 递增 | 从0开始计数 | 总游戏帧数 |
| `cyclePosition` | 0-18000 | 循环 | 当前周期位置 |
| `dayNightTransitionAlpha` | 0.0-1.0 | 动态 | 过渡进度因子 |
| `currentBackgroundColor` | RGB值 | 动态 | 当前背景色 |
| `score` | 递增 | 线性增长 | **分数与时间成正比** |

## 🎯 分数与时间的线性关系

```
分数计算：
    score += GameConfig::scorePerFrame  // 每帧增加的分数（配置为1）
    gameFrameCount++                    // 每帧时间递增

因此：
    分数 = gameFrameCount × scorePerFrame
    分数 = 总游戏帧数 × 1
    分数 ≈ 游戏进行的秒数 × 60 / 60 = 游戏进行的秒数

示例：
    游戏进行30秒 → 约1800帧 → 分数约1800
    游戏进行2分钟 → 约7200帧 → 分数约7200
```

**关键特性：** 分数严格与游戏经过时间成线性关系 ✓

## 🌈 背景色渐变过程

### 白天 → 黑夜过渡

```
第1秒：RGB(255, 255, 255) - 纯白
第40秒：RGB(215, 215, 225) - 浅灰
第74秒：RGB(165, 165, 175) - 中灰
最后秒：RGB(100, 100, 120) - 深灰（黑夜）

变化公式：
    R = 255 × (1 - progress) + 100 × progress
    G = 255 × (1 - progress) + 100 × progress
    B = 255 × (1 - progress) + 120 × progress
    
其中 progress = (经过时间秒数) / 75
```

### 黑夜 → 白天过渡

```
第1秒：RGB(100, 100, 120) - 深灰（黑夜）
第40秒：RGB(165, 165, 175) - 中灰
第74秒：RGB(215, 215, 225) - 浅灰
最后秒：RGB(255, 255, 255) - 纯白
```

## ☁️ 云朵透明度变化

```
白天：
    透明度 = 1.0 (100% 可见)
    所有云朵正常绘制

白→黑过渡（75秒）：
    透明度从 1.0 逐渐降低到 0.0
    云朵逐渐淡出屏幕

黑夜：
    透明度 = 0.0 (0% 可见)
    云朵完全隐藏（不渲染）
    
黑→白过渡（75秒）：
    透明度从 0.0 逐渐升高到 1.0
    云朵逐渐淡入屏幕

变化公式：
    cloudAlpha = 1.0 - dayNightTransitionAlpha
```

## 🔄 循环周期详解

```
        白天(150s)
       ┌─────────┐
       │         │
    ┌──┴──┐   ┌──┴──┐
    │过渡1 │   │过渡4 │
    │75s  │   │75s  │
    └──┬──┘   └──┬──┘
       │         │
       │       黑夜(75s)
       │    ┌──────────┐
       └────┤          │
            └────┬─────┘
        总周期：300秒 (18000帧)
```

## 💾 游戏重置时的初始化

```cpp
resetGame() 调用时：
    gameFrameCount = 0           // 时间计数器重置
    cyclePosition = 0            // 周期位置回到开始
    dayNightTransitionAlpha = 0.0f  // 过渡进度清零
    currentBackgroundColor = QColor(255, 255, 255)  // 背景回到白色
    score = 0                    // 分数重置
    isNight = false              // 状态回到白天
```

## 🚀 编译运行

```bash
cd /Users/luvwq/Documents/大学资料/课程资料/大一/C语言课/202512游戏项目/Codes
mkdir -p build && cd build
cmake ..
make
./Codes  # 运行游戏
```

## ✨ 验证清单

- [x] 分数与时间线性关系实现
- [x] 白天背景色为纯白
- [x] 黑夜背景色为深灰
- [x] 过渡期背景平滑渐变
- [x] 云朵在过渡期逐渐消失
- [x] 云朵在黑夜完全隐藏
- [x] 300秒后周期循环
- [x] 游戏重置时正确初始化

## 📝 配置调整指南

要修改昼夜循环速度，编辑 `gameconfig.h`：

```cpp
// 更快的周期（2分钟）
constexpr int dayNightCycleFrames = 7200;   // 120秒
constexpr int dayDurationFrames = 3600;     // 60秒（白天）
constexpr int transitionFrames = 1800;      // 30秒（过渡）

// 更慢的周期（10分钟）
constexpr int dayNightCycleFrames = 36000;  // 600秒
constexpr int dayDurationFrames = 18000;    // 300秒（白天）
constexpr int transitionFrames = 9000;      // 150秒（过渡）
```

重新编译即可生效。

